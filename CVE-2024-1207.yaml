id: CVE-2024-1207
info:
  name: WP Booking Calendar SQL Injection Vulnerability
  author: CyberXTron Technologies
  severity: high
  description: The WP Booking Calendar plugin for WordPress is vulnerable to SQL Injection due to insufficient escaping on user-supplied parameter and lack of preparation in the existing SQL query. This affects versions up to and including 9.9.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/7802ed1f-138c-4a3d-916c-80fb4f7699b2?source=cve
    - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3032596%40booking&new=3032596%40booking&sfp_email=&sfph_mail=

http:
  - method: GET
    path:
      - '{{BaseURL}}'
    matchers:
      - type: regex
        part: body
        regex:
          - (\/plugins\/booking\/js\/wpbc_vars\.js\?ver=)(9\.9\"|9\.[0-8]|[0-8]\.[0-9])
    extractors:
      - type: regex
        part: body
        regex:
          - (\/plugins\/booking\/js\/wpbc_vars\.js\?ver=)(9\.9\"|9\.[0-8]|[0-8]\.[0-9])
        group: 2  
        name: version
